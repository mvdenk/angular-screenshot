/*! Angular Screenshot - v0.1.0 - http://weihanchen.github.io/angular-screenshot - (c) 2017 weihanchen - MIT */
!function(e){function t(o){if(n[o])return n[o].exports;var r=n[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=9)}([function(e,t,n){"use strict";var o=n(8),r=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(o),a=n(2);r.module("angular-screenshot",[]).directive("screenshot",a.screenshot).directive("screenshotToolbox",a.screenshotToolbox)},function(e,t){},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.screenshotToolbox=t.screenshot=void 0;var r=n(4),a=o(r),s=n(3),c=o(s);t.screenshot=a.default,t.screenshotToolbox=c.default,t.default={screenshot:a.default,screenshotToolbox:c.default}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){return{restruct:"E",template:'<div class="screenshot-toolbox-custom" ng-transclude></div>',require:"^screenshot",link:function(e,t,n,o){var r=t.children().html();o.setTemplate(r,e)},transclude:!0}};t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(7),r=function(){return{restrict:"AE",scope:{target:"@",isOpen:"=",toolboxOptions:"=?",api:"=?"},controller:["$scope","$element","$compile","$timeout",function(e,t,n,r){var a={gray:"#898b89",lightGray:"#e6e3e3"},s={top:1,second:0},c=this,u=function(e,t,n,o,r){var a=e+n.startX+n.w,s=t+n.startY+n.h;return n.w>=0&&(a-=o),n.h>=0?s+=5:s=s-r-5,{left:a,top:s}},i=function(){o.domprocess.remove(c.toolboxElement),o.domprocess.clearCanvasRect(c.interactiveCanvas)},l=function(){var e=d();o.domcapture.getCanvas(e).then(o.domprocess.canvasToImage).then(function(e){return o.domprocess.clipImageToCanvas(e,c.rect.startX,c.rect.startY,c.rect.w,c.rect.h)}).then(function(e){return o.domprocess.downloadCanvas(e,c.filename)})},f=function(){var e=0;return angular.element("body *").each(function(){var t=angular.element(this).css("zIndex");t>e&&(e=t)}),e},d=function(){return c.target?angular.element(c.target)[0]:t.children().filter(function(e,t){return"screenshot-toolbox"!==t.tagName.toLowerCase()})[0]},p=function(){var e=f();s.second=e+1,s.top=s.second+1},m=function(){o.domprocess.remove(c.toolboxElement)},v=function(t,r){if(0!=r.w&&0!=r.h){o.domprocess.remove(c.toolboxElement),c.rect=r;var a=n(c.template)(c.templateScope);e.$apply();var i=a[0];o.domprocess.setToolboxStackStyle(i,s.top).then(o.domprocess.appendToBody).then(function(e){var n=u(t.offsetLeft,t.offsetTop,r,e.offsetWidth,e.offsetHeight);return o.domprocess.setToolboxPositionStyle(e,n.left,n.top)}).then(function(e){c.toolboxElement=e})}},h=function(){c.isOpen=!1,e.$apply()},g=function(){o.domprocess.remove(c.interactiveCanvas),o.domprocess.remove(c.toolboxElement)},x=function(){var e=d(),t=angular.element(e),n=t.outerWidth(!0),r=t.outerHeight(!0),u=t.offset(),i=u.left,l=u.top;p(),o.domprocess.createCanvas(n,r).then(function(e){return o.domprocess.setCanvasStyle(e,i,l,a.gray,s.second)}).then(o.domprocess.appendToBody).then(function(e){return o.domprocess.listenInteractiveCanvas(e,a.lightGray,v,m,h)}).then(function(e){return c.interactiveCanvas=e})},b=function(e,t){c.template=e,c.templateScope=t};c.cancel=i,c.download=l,c.interactiveCanvas,c.rect={},c.toolboxElement,c.cancelText="Cancel",c.downloadText="Download",c.filename="screenshot.png",c.setTemplate=b,c.template='<div class="screenshot-toolbox"><button class="btn" type="button" ng-click="screenshotCtrl.cancel()">{{screenshotCtrl.cancelText}}</button><button class="btn" type="button" ng-click="screenshotCtrl.download()">{{screenshotCtrl.downloadText}}</button></div>',c.templateScope=e,r(function(){return c.api={download:l,cancel:i}}),e.$watch(function(){return c.isOpen},function(e){e===!0?x():e===!1&&g()}),e.$watch(function(){return c.toolboxOptions},function(e){angular.isObject(e)&&(c.cancelText=e.cancelText?e.cancelText:c.cancelText,c.downloadText=e.downloadText?e.downloadText:c.downloadText,c.filename=e.filename?e.filename:c.filename)})}],controllerAs:"screenshotCtrl",bindToController:!0}};t.default=r},function(e,t,n){"use strict";function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return s(e).then(function(t){var n=document.createElement("style");return e.appendChild(n),n.appendChild(document.createTextNode(t)),e})},a=function(e){return new Promise(function(t,n){var o=new Image;o.onload=function(){t(o)},o.onerror=n,o.src=e})},s=function(){var e=document.styleSheets;if(!e)return Promise.resolve("");var t=l(e),n=t.reduce(function(e,t){var n=t.rules||t.cssRules;if(n){var r=l(n);e.push.apply(e,o(r.map(function(e){return e.cssText})))}return e},[]).filter(function(e){return e}).join("");return Promise.resolve(n)},c=function(e){return Promise.resolve(e).then(function(e){return e.setAttribute("xmlns",e.namespaceURI),(new XMLSerializer).serializeToString(e)}).then(function(e){return"<foreignObject x='0' y='0' width='100%' height='100%'>"+e+"</foreignObject>"}).then(function(e){return"<svg xmlns='http://www.w3.org/2000/svg' width='100%' height='100%'>"+e+"</svg>"}).then(function(e){return"data:image/svg+xml;charset=utf-8,"+e})},u=function(e){var t=e.cloneNode(!0),n=e.offsetWidth,o=e.offsetHeight;return Promise.resolve(t).then(r).then(c).then(a).then(function(e){var t=document.createElement("canvas");return t.width=n,t.height=o,t.getContext("2d").drawImage(e,0,0),t})},i=function(e){var t=e.cloneNode(!0);return Promise.resolve(t).then(r).then(c).then(a)},l=function(e){return Object.keys(e).map(function(t){return e[t]})},f={getCanvas:u,getCanvasImage:i};t.default=f},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){return document.body.appendChild(e),Promise.resolve(e)},r=function(e){return new Promise(function(t,n){var o=e.toDataURL("image/png"),r=new Image;r.onload=function(){t(r)},r.onerror=n,r.src=o})},a=function(e){e.getContext("2d").clearRect(0,0,e.width,e.height)},s=function(e,t,n,o,r){return u(Math.abs(o),Math.abs(r)).then(function(a){return a.getContext("2d").drawImage(e,t,n,o,r,0,0,a.width,a.height),a})},c=function(e,t){var n=e.toDataURL("image/png"),o=document.createElement("a");return o.href=n,o.download=t,o.target="_blank",o.click(),o.remove(),Promise.resolve(e)},u=function(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,Promise.resolve(n)},i=function(e,t,n,o,r){var a=e.getContext("2d"),s={startX:0,startY:0,w:0,h:0},c=!1,u=function(){a.fillStyle=t,a.fillRect(s.startX,s.startY,s.w,s.h)},i=function(t){a.clearRect(0,0,e.width,e.height),s.startX=t.pageX-e.offsetLeft,s.startY=t.pageY-e.offsetTop,o(s),s.w=0,s.h=0,c=!0},l=function(t){c&&(s.w=t.pageX-e.offsetLeft-s.startX,s.h=t.pageY-e.offsetTop-s.startY,a.clearRect(0,0,e.width,e.height),u())},f=function(){c=!1,n(e,s)},d=function(e){return r(),e.preventDefault(),!1};return e.addEventListener("mousedown",i,!1),e.addEventListener("mouseup",f,!1),e.addEventListener("mousemove",l,!1),e.addEventListener("contextmenu",d,!1),Promise.resolve(e)},l=function(e){e&&e.remove()},f=function(e,t,n,o,r){return e.style.cursor="crosshair",e.style.position="absolute",e.style.left=t+"px",e.style.top=n+"px",e.style.background=o,e.style.zIndex=r,e.style.opacity=.5,Promise.resolve(e)},d=function(e,t,n){return e.style.left=t+"px",e.style.top=n+"px",Promise.resolve(e)},p=function(e,t){return e.style.position="absolute",e.style.zIndex=t,Promise.resolve(e)},m={appendToBody:o,canvasToImage:r,clearCanvasRect:a,clipImageToCanvas:s,createCanvas:u,downloadCanvas:c,listenInteractiveCanvas:i,remove:l,setCanvasStyle:f,setToolboxPositionStyle:d,setToolboxStackStyle:p};t.default=m},function(e,t,n){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0}),t.domprocess=t.domcapture=void 0;var r=n(5),a=o(r),s=n(6),c=o(s);t.domcapture=a.default,t.domprocess=c.default,t.default={domcapture:a.default,domprocess:c.default}},function(e,t){e.exports=angular},function(e,t,n){n(0),e.exports=n(1)}]);